%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\documentclass[apj]{emulateapj}
\documentclass[preprint]{emulateapj}
%\documentclass[12pt,preprint]{aastex}


\usepackage[table,usenames,dvipsnames]{xcolor}
\usepackage{amsmath}
\usepackage{subfigure}
\usepackage[backref,breaklinks,colorlinks,citecolor=blue]{hyperref}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{multirow}

\newcommand{\sqdeg}{deg$^2$ }
\newcommand{\omb}{\ensuremath{\Omega_b h^2}}
\newcommand{\omc}{\ensuremath{\Omega_c h^2}}
\newcommand{\clpp}{\ensuremath{C_{L}^{\phi\phi}}}
\newcommand{\cpmf}{\ensuremath{C_{\ell}^{\rm pmf}}}
\newcommand{\apmf}{\ensuremath{A_{\rm pmf}}}
\newcommand{\bpmf}{\ensuremath{B_{\rm 1\,Mpc}}}
\newcommand{\alens}{\ensuremath{A_{\rm lens}}}
\newcommand{\lcdm}{\ensuremath{\Lambda}CDM}


\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\planck}{{\sl Planck}}
\newcommand{\wmap}{{\sl WMAP}}
\newcommand{\bicepkeck}{BICEP2/Keck}
\newcommand{\sptnew}{SPT-3G}
\newcommand{\pb}{POLARBEAR}
\newcommand{\simons}{Simons Array}
\newcommand{\sptpol}{SPTpol}
\newcommand{\advactpol}{Adv.~ACTpol}

\newcommand{\tbd}[1]{\textcolor{Red}{{\bf TBD}: #1}}
\newcommand{\gab}[1]{\textcolor{Orchid}{[{\bf GS}: #1]}}

\bibliographystyle{fapj}

% ref to section \S\ref{sec:label}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\title{Current and future constraints on primordial magnetic fields}
\author{TBD}

\email{christian.reichardt@unimelb.edu.au}

\begin{abstract}

We present new limits on the amplitude of any primordial magnetic field (PMF) using temperature and polarization measurements of the cosmic microwave background (CMB)  from \planck{}, \bicepkeck{}, \pb, and \sptpol. 
We reduce six-fold the upper limit on the CMB anisotropy power due to a PMF, from $\apmf < 2.0\tbd{XX}$ from Planck alone to $\apmf < 0.33$ for the combined dataset at 95\% CL. 
Most of the improvement is due to the addition of the \bicepkeck{} data; without these bandpowers, the combined limit weakens to $\apmf < 0.\tbd{XX}$. 
We also consider future limits from stage III CMB experiments (like \sptnew{},  \advactpol, or the \simons) and a stage IV concept. 
Stage III experiments will reduce the current limit by an additional factor of \tbd{XX}; this will become a factor of \tbd{XX} for stage IV. 
\tbd{maybe:} The constraints from a stage IV experiment have the potential to rule out much of the parameter space for PMFs. \tbd{really if could rule out them as explanation for galaxy fields... is there a lower bound for them to be useful?}

\end{abstract}

\keywords{dark energy --- cosmic background radiation --- early universe }
\section{Introduction}
\label{sec:intro}

The outline of the paper is as follows. 
In \S\ref{sec:data}, we lay out the data used and the MCMC implementation used to constrain the PMF amplitude. 
We present the results of this analysis on current data in \S\ref{sec:results}. 
The assumed parameters for future experiments and the resulting Fisher matrix forecasts are described in \S\ref{sec:forecasts}. 
We conclude in \S\ref{sec:conclusions}. 

\section{Data and Methods}
\label{sec:data}

We use  Markov chain Monte Carlo (MCMC) methods to study constraints on the primordial magnetic field. 
In this section, we first describe the CMB temperature and polarization anisotropy data used, and then discuss the MCMC implementation. 




\subsection{Data}

We use a compendium of current measurements of the CMB temperature and polarization anisotropies from ground-based and satellite experiments. 
We use \planck{} data from the 2015 release to constrain the TT, TE, EE and lensing power spectra. 
Specifically, these are the ``plik\_dx11dr21\_HM\_v18\_TT", ``lowTEB" and ``lensing" \planck{} likelihood modules. 


In addition to the \planck{} data, we use all recent CMB polarization measurements that are publicly available. 
First, we include TE and EE spectrum measurements\citep{crites15} for $\ell \in [500,3000]$ and BB bandpowers covering $\ell \in [500,2000]$ \citep{keisler15} from SPTpol. 
We also add the BB bandpowers from \pb{} that cover the multipoles from 500 to 2500 \citep{pb-bb15}. 
Both the \sptpol{} and \pb{} bandpowers primary constrain the vector mode of the PMF given the angular scales measured. 
Finally, we include the joint BICEP2, Keck Array and \planck{} joint analysis \citep{bicepkeckplanck15}. 
This latter dataset also places limits on the tensor mode of the PMF due to its coverage of lower multipoles. 
In all chains, we marginalize over the recommended foreground models for each data set. 
We do not however require these consistency between these foreground models since the data don't have identical flux cuts and so on. 
In the case of an upper limit this treatment is conservative since weaker foreground constraints or residual point source power would only add power and weaken the limit on the PMF. 

\subsection{Methods}

We use MCMC methods to determine the parameter constraints reported in this work. 
The results are calculated using  the {\textsc CosmoMC}\footnote{http://cosmologist.info/cosmomc (Aug 2011)} package \citep{lewis02b}. 
CosmoMC invokes  CAMB\footnote{http://camb.info (July 2011)}  \citep{lewis00} to calculate the CMB power spectrum for each set of cosmological parameters. 
Although CosmoMC and CAMB have a partial implementation of PMF, we choose to adopt a simpler, fast template-based calculation for the PMF power. 
We have adapted CosmoMC to add a scaled version of the template to all four CMB power spectra: TT, TE, EE, and BB, where the scale factor is \apmf. 
\be
C_\ell = C_\ell (CAMB) + \apmf \cpmf
\ee
The calculation of the PMF template, \cpmf, is described later. 
Note that no other effect of the PMF is considered; this is one reason we only consider CMB data.

Unless noted, we assume the six parameter spatially flat \lcdm{} model with a single massive neutrino of 60\,meV and a seventh parameter \apmf{} describing the power due to the PMF. 
We adopt flat priors on all parameters. 
In particular, note that this is a flat prior on the observed PMF power, $\apmf$, not the rms magnetic field strength, \bpmf, that has often been used in the literature. 
In many chains, we also add \alens{} as a simple way of marginalizing over uncertainty in the predicted lensed BB power spectrum for any extension to the \lcdm{} model. 
Finally, in some cases, we allow non-zero tensors, parameterized as is normal, by the tensor-to-scalar ratio, r. 

\subsection{Primordial Magnetic Field Template}

\tbd{Chang to describe the template calculation and template parameters}

We can translate the amplitude constraint on this template to a constraint rms magnetic field strength on 1\,Mpc scales , \bpmf, using the expected scaling:
\be
\apmf \propto \bpmf^4.
\ee
An unfortunate consequence of this steep scaling is that substantial reductions in the observationally allowed power lead to only modestly better limits on the magnetic field strength. 
However, if a PMF is detected, this same steep scaling would allow excellent constraints on its properties. 
 
\section{Results}
\label{sec:results}

We find the addition of ground-based CMB polarization data to \planck{} data substantially improves the upper limits on the allowed power due to a PMF, leading to a factor of two improvement. 
With Planck alone, the 95\% confidence upper limit is $\apmf <  0.68$ when $\alens$ is allowed to vary; with the ground-based experiments, this limit drops to $\apmf <  0.33$. 
We test which datasets are important by adding single datasets to the \planck{} set, and find that the majority of this improvement is due to the \bicepkeck{} ($\apmf <  0.36$) and \sptpol{} ($\apmf <  0.42$) B-mode power spectrum measurements. 
The other datasets do not have a large impact on the observed limits. 

We propagate these limits on the observed PMF power into limits on the magnetic field strength, \bpmf. 
Due to the scaling with the fourth power, an upper limit with a flat prior on \apmf{} would lead to an apparent `detection' of \bpmf. 
We therefor importance sample the chains to generate a flat prior on \bpmf. 
We find a 95\% limit of $\bpmf < XX$\,nG for \planck{} alone, consistent with \citep{planckpmf} with $n$ held fixed as we've done. 
This is reduced to $\bpmf < XX$\,nG for the combined dataset. 











\begin{table*}[htb]
\begin{center}
\caption{\label{tab:param_all} All parameter constraints}
\tiny
\begin{tabular}{l || c c c c c c c | c}
Chain & $\Omega_b h^2$  & $\Omega_c h^2$  & $\theta$  & $\tau$  & logA  & $n_s$  & $A_{lens}$  & $A_{pmf}$ \\
lcdm\_alens\_all & $ 0.02240\pm  0.00026$ & $ 0.1179\pm  0.0020$ & $ 1.04106\pm  0.00047$ & $ 0.064\pm  0.016$ & $ 3.057\pm  0.030$ & $ 0.9696\pm  0.0062$ & $ 1.121 \pm  0.064$ & $< 0.33$ \\
lcdm\_alens\_nopmf\_all & $ 0.02241\pm  0.00024$ & $ 0.1179\pm  0.0020$ & $ 1.04106\pm  0.00047$ & $ 0.065\pm  0.016$ & $ 3.059\pm  0.029$ & $ 0.9694\pm  0.0062$ & $ 1.136 \pm  0.063$ & $< 0.00$ \\
lcdm\_alens\_nopmf\_planck & $ 0.02256\pm  0.00027$ & $ 0.1173\pm  0.0021$ & $ 1.04121\pm  0.00048$ & $ 0.069\pm  0.017$ & $ 3.067\pm  0.030$ & $ 0.9721\pm  0.0063$ & $ 1.175 \pm  0.067$ & $< 0.00$ \\
lcdm\_alens\_planckTT & $ 0.02252\pm  0.00031$ & $ 0.1174\pm  0.0027$ & $ 1.04122\pm  0.00053$ & $ 0.070\pm  0.050$ & $ 3.068\pm  0.098$ & $ 0.9713\pm  0.0080$ & $ 1.155 \pm  0.136$ & $< 1.34$ \\
lcdm\_alens\_planckTT\_TEB & $ 0.02264\pm  0.00029$ & $ 0.1161\pm  0.0025$ & $ 1.04141\pm  0.00053$ & $ 0.055\pm  0.021$ & $ 3.036\pm  0.042$ & $ 0.9755\pm  0.0072$ & $ 1.241 \pm  0.104$ & $< 0.77$ \\
lcdm\_alens\_planck & $ 0.02254\pm  0.00026$ & $ 0.1173\pm  0.0020$ & $ 1.04121\pm  0.00046$ & $ 0.068\pm  0.016$ & $ 3.065\pm  0.030$ & $ 0.9723\pm  0.0062$ & $ 1.171 \pm  0.070$ & $< 0.68$ \\
lcdm\_alens\_planck\_bicep & $ 0.02255\pm  0.00026$ & $ 0.1174\pm  0.0020$ & $ 1.04120\pm  0.00047$ & $ 0.069\pm  0.017$ & $ 3.067\pm  0.030$ & $ 0.9724\pm  0.0063$ & $ 1.177 \pm  0.068$ & $< 0.36$ \\
lcdm\_alens\_planck\_pb & $ 0.02255\pm  0.00027$ & $ 0.1173\pm  0.0021$ & $ 1.04119\pm  0.00046$ & $ 0.068\pm  0.017$ & $ 3.066\pm  0.031$ & $ 0.9725\pm  0.0064$ & $ 1.171 \pm  0.068$ & $< 0.63$ \\
lcdm\_alens\_planck\_sptpolB & $ 0.02254\pm  0.00026$ & $ 0.1173\pm  0.0020$ & $ 1.04121\pm  0.00047$ & $ 0.069\pm  0.017$ & $ 3.067\pm  0.030$ & $ 0.9724\pm  0.0062$ & $ 1.159 \pm  0.067$ & $< 0.42$ \\
lcdm\_alens\_planck\_sptpolE & $ 0.02239\pm  0.00025$ & $ 0.1178\pm  0.0020$ & $ 1.04107\pm  0.00048$ & $ 0.064\pm  0.016$ & $ 3.057\pm  0.030$ & $ 0.9698\pm  0.0061$ & $ 1.119 \pm  0.067$ & $< 0.73$ \\
lcdm\_planck & $ 0.02225\pm  0.00023$ & $ 0.1184\pm  0.0020$ & $ 1.04102\pm  0.00047$ & $ 0.066\pm  0.017$ & $ 3.062\pm  0.030$ & $ 0.9682\pm  0.0060$ & $ 0.000 \pm  0.000$ & $< 0.73$ \\
lcdm\_r\_alens\_all & $ 0.02240\pm  0.00025$ & $ 0.1178\pm  0.0020$ & $ 1.04107\pm  0.00046$ & $ 0.064\pm  0.016$ & $ 3.056\pm  0.029$ & $ 0.9702\pm  0.0062$ & $ 1.123 \pm  0.063$ & $< 0.27$ \\
\end{tabular}
\tablecomments{ 
Summary of results (will be trimmed for paper). 
} \normalsize
\end{center}
\end{table*}

\section{Forecasts}
\label{sec:forecasts}

\section{Conclusions}
\label{sec:conclusions}



\bibliography{pmf}


\end{document}